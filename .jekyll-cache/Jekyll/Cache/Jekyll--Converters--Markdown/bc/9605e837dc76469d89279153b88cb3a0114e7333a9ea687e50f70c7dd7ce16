I"Ê(<h1 id="neural-machine-translation-by-jointly-learning-to-align-and-translate">Neural Machine Translation By Jointly Learning To Align And Translate</h1>
<p>title: Neural Machine Translation By Jointly Learning To Align And Translate
subtitle: Attention seq2seq
categories: Paper Review
tags: NLP
date: 2021-01-19 13:01:18 +0000
last_modified_at: 2021-01-19 13:01:18 +0000
â€”</p>

<p>Archive Link: https://arxiv.org/abs/1409.0473
Created: Sep 21, 2020 3:15 PM
Field: NLP
Paper Link: https://arxiv.org/pdf/1409.0473.pdf
Status: completed
Submit Date: Sep 1, 2014</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">cleanUrl</span><span class="pi">:</span> <span class="s">/nlp/neural-machine-translation-by-jointly-learning-to-align-and-translate</span>
<span class="na">disqus</span><span class="pi">:</span> <span class="no">true</span>
</code></pre></div></div>

<h1 id="abstract">Abstract</h1>

<p>ê¸°ì¡´ì˜ seq2seq modelì—ì„œ ì‚¬ìš©ëœ LSTMì„ ì‚¬ìš©í•œ encoder-decoder modelì€ sequential problemì—ì„œ ë›°ì–´ë‚œ ì„±ëŠ¥ì„ ë³´ì˜€ë‹¤. í•˜ì§€ë§Œ encoderì—ì„œ ìƒì„±í•´ë‚¸ context vectorë¥¼ decoderì—ì„œ sentenceë¡œ ë§Œë“¤ì–´ë‚´ëŠ” ìœ„ì™€ ê°™ì€ ë°©ì‹ì—ì„œ ê³ ì •ëœ vector sizeëŠ” ê¸´ lengthì˜ sentenceì—ì„œ bottleneckì´ ëœë‹¤ëŠ” ì‚¬ì‹¤ì„ ë°œê²¬í–ˆë‹¤. ë³¸ ë…¼ë¬¸ì—ì„œëŠ” ì´ëŸ¬í•œ ë¬¸ì œì ì„ í•´ê²°í•˜ê¸° ìœ„í•´ source sentenceì˜ ì •ë³´ë¥¼ context vector í•˜ë‚˜ì— ë‹´ëŠ” ê²ƒì´ ì•„ë‹Œ, ê° ì‹œì ë§ˆë‹¤ì˜ context vectorë¥¼ ë”°ë¡œ ìƒì„±í•´ decoderì—ì„œ ì‚¬ìš©í–ˆë‹¤.</p>

<h1 id="decoder">Decoder</h1>

<p><img src="assets/images/2021-01-19-Neural-Machine-Translation-By-Jointly-Learning-To-Align-And-Translate/Untitled.png" alt="Neural%20Machine%20Translation%20By%20Jointly%20Learning%20To%20%20aee56874a5c645b08df4a6b823d6e1f7/Untitled.png" /></p>

<p><img src="assets/images/2021-01-19-Neural-Machine-Translation-By-Jointly-Learning-To-Align-And-Translate/Untitled%201.png" alt="Neural%20Machine%20Translation%20By%20Jointly%20Learning%20To%20%20aee56874a5c645b08df4a6b823d6e1f7/Untitled%201.png" /></p>

<p><img src="assets/images/2021-01-19-Neural-Machine-Translation-By-Jointly-Learning-To-Align-And-Translate/Untitled%202.png" alt="Neural%20Machine%20Translation%20By%20Jointly%20Learning%20To%20%20aee56874a5c645b08df4a6b823d6e1f7/Untitled%202.png" /></p>

<p>$i$ë²ˆì§¸ tokenìœ¼ë¡œ $y_i$ê°€ ë“±ì¥í•  ì¡°ê±´ë¶€ í™•ë¥ ì— ëŒ€í•œ ìˆ˜ì‹ì´ë‹¤. $y_1 \sim y_{i-1}$ ($y_i$ ì´ì „ì˜ output sentence)ì™€ $x$(input sentence ì „ì²´)ì— ëŒ€í•´ ë‹¤ìŒ tokenìœ¼ë¡œ $y_i$ê°€ ìƒì„±ë  ì¡°ê±´ë¶€ í™•ë¥ ì´ë‹¤. ì´ëŠ” $g$ í•¨ìˆ˜ì— $y_{i-1}$, $s_i$,  $c_i$ë¥¼ ì¸ìë¡œ ë„£ì–´ ìƒì„±ëœ ê°’ì´ë‹¤. $y_{i-1}$ì€ ì§ì „ ì‹œì  $i-1$ì—ì„œ ìƒì„±í•œ output tokenì´ê³ , $s_i$ëŠ” í˜„ì¬ ì‹œì  $i$ì—ì„œì˜ RNN hidden state, $c_i$ëŠ” í˜„ì¬ ì‹œì  iì— ìƒì„±ëœ context vectorì´ë‹¤. ì§ê´€ì ìœ¼ë¡œ í•´ì„í•´ë³´ë©´ ì´ì „ ë‹¨ì–´ $y_{i-1}$ ì´í›„ì— ë‚˜ì˜¬ ë‹¨ì–´ $y_i$ë¥¼ ì˜ˆì¸¡í•˜ëŠ” ê²ƒì¸ë°, ì´ ë•Œ ì´ì „ output sentenceì˜ ìƒíƒœ ì •ë³´ë¥¼ ëª¨ë‘ í¬í•¨í•˜ê³  ìˆëŠ” $s_i$ë¥¼ ì…ë ¥ìœ¼ë¡œ ë°›ìŒìœ¼ë¡œì¨ output sentenceì˜ ë¬¸ë§¥ì„ ë°˜ì˜í•˜ê³ , input sentenceì— ëŒ€í•œ context vector $c_i$ë¥¼ í†µí•´ input sentenceì˜ ë¬¸ë§¥ì„ ë°˜ì˜í•œë‹¤. ì´ì „ seq2seq modelì—ì„œëŠ” context vectorê°€ input sentence ì „ì²´ì— ëŒ€í•œ vectorì˜€ëŠ”ë°, ì´ë²ˆ attention seq2seq modelì—ì„œëŠ” íŠ¹ì • ì‹œì  iì— ëŒ€í•œ context vector $c_i$ê°€ ì£¼ì–´ì§„ë‹¤. ì¦‰, context vectorê°€ input sentence ì „ì²´ì— ëŒ€í•œ í•˜ë‚˜ì˜ vectorê°€ ì•„ë‹ˆë¼ ê° ì‹œì  iì— ëŒ€í•´ $c_i$ê°€ ê°ê° ì •ì˜ëœë‹¤ëŠ” ê²ƒì´ë‹¤. ì•„ë˜ì—ì„œëŠ” $c_i$ì— ëŒ€í•´ ì¢€ ë” ìì„¸í•˜ê²Œ ì‚´í´ë³¸ë‹¤.</p>

\[c_i=\sum^{T_x}_{j=1}{\alpha_{ij}h_j}\]

<p>$c_i$ëŠ” $a_{ij}$ì™€ $h_j$ì— ëŒ€í•´ $j$ë¶€í„° $T_x$ê¹Œì§€ ë”í•œ vectorì´ë‹¤. $j$ë¶€í„° $T_x$ê¹Œì§€ì˜ ì˜ë¯¸ëŠ” input sentenceì˜ ì²˜ìŒë¶€í„° ëê¹Œì§€ ê° input tokenì— ëŒ€í•´ $j$ë¡œ ìˆœíšŒí•œë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤. ì¦‰, $j$ëŠ” input sentenceì—ì„œì˜ token indexì´ë‹¤. ë°˜ëŒ€ë¡œ $i$ëŠ” output sentenceì—ì„œ í˜„ì¬ ì‹œì  iì´ë‹¤. ì •ë¦¬í•˜ìë©´ $j$ëŠ” inputì— ëŒ€í•œ index, $i$ëŠ” outputì— ëŒ€í•œ indexì´ë‹¤. ìš°ë¦¬ëŠ” outputì˜ $i$ ì‹œì ì—ì„œ ìƒì„±ë˜ëŠ” context vector $c_i$ì— ëŒ€í•œ ìˆ˜ì‹ì„ ì‚´í´ë³´ëŠ” ê²ƒì´ë‹¤. $h_j$ëŠ” input sentence ì „ì²´ì˜ contextë¥¼ í¬í•¨í•˜ì§€ë§Œ ë™ì‹œì— íŠ¹íˆ $j$ë²ˆì§¸ tokenê³¼ ê·¸ ì£¼ë³€ì— ëŒ€í•´ ë” attention(ì§‘ì¤‘)ì„ í•œ vectorì´ë‹¤.$a_{ij}$ëŠ” $i$ë²ˆì§¸ output tokenì´ $j$ë²ˆì§¸ input tokenê³¼ alignë  í™•ë¥ ê°’ì„ ëœ»í•œë‹¤. $a_{ij}$ì— ëŒ€í•´ ë” ì‚´í´ë³´ì.</p>

<p><img src="assets/images/2021-01-19-Neural-Machine-Translation-By-Jointly-Learning-To-Align-And-Translate/Untitled%203.png" alt="Neural%20Machine%20Translation%20By%20Jointly%20Learning%20To%20%20aee56874a5c645b08df4a6b823d6e1f7/Untitled%203.png" /></p>

<p><img src="assets/images/2021-01-19-Neural-Machine-Translation-By-Jointly-Learning-To-Align-And-Translate/Untitled%204.png" alt="Neural%20Machine%20Translation%20By%20Jointly%20Learning%20To%20%20aee56874a5c645b08df4a6b823d6e1f7/Untitled%204.png" /></p>

<p>$e_{ij}$ëŠ” $i$ë²ˆì§¸ì— ë“¤ì–´ì˜¬ output tokenê³¼ $j$ë²ˆì§¸ input tokenì´ ì–¼ë§ˆë‚˜ ì„œë¡œ ì˜ matchë˜ëŠ”ì§€ì— ëŒ€í•œ ê°’ì´ë‹¤. outputì˜ ë¬¸ë§¥ì„ ë°˜ì˜í•˜ê¸° ìœ„í•´ $s_{i-1}$ë¥¼ inputìœ¼ë¡œ ë°›ê³ , $j$ë²ˆì§¸ input tokenì— ëŒ€í•œ attentionì„ ì£¼ê¸° ìœ„í•´ $h_j$ë¥¼ inputìœ¼ë¡œ ë°›ëŠ”ë‹¤. ì´ë ‡ê²Œ ì™„ì„±ëœ $e_{ij}$ë¥¼ softmaxí•œ $a_{ij}$ëŠ” $i$ë²ˆì§¸ ë“¤ì–´ì˜¬ output tokenê³¼ $j$ë²ˆì§¸ input tokenì´ alignë  í™•ë¥ ê°’ì„ ëœ»í•œë‹¤.</p>

<p>ë‹¤ì‹œ$c_i$ì˜ ì˜ë¯¸ë¡œ ë˜ëŒì•„ì™€ë³´ë©´, $c_i$ëŠ” $i$ ì‹œì ì—ì„œ ëª¨ë“  input sentence token $j$ì— ëŒ€í•´ $a_{ij}$ì™€ $h_j$ë¥¼ ê³±í•œ vectorì— ëŒ€í•œ í•©ì´ë‹¤. $a_{ij}$ëŠ” í˜„ì¬ ì‹œì  $a_i$ì—ì„œ ìƒì„±ë  output tokenì´ $j$ë²ˆì§¸ input tokenê³¼ alignë  í™•ë¥ ê°’ì´ë©°, $h_j$ëŠ” input sentenceì— ëŒ€í•œ contextì´ë˜, $j$ë²ˆì§¸ input tokenì— íŠ¹íˆ attentioní•œ vectorì´ë‹¤. ê²°ë¡ ì ìœ¼ë¡œ $c_i$ëŠ” í˜„ì¬ ì‹œì  $i$ì—ì„œ input sentenceì˜ ì–´ëŠ tokenì— ë” attentionì„ í•´ì•¼ í•˜ëŠ”ì§€ì— ëŒ€í•œ contextë¼ê³  ì§ê´€ì ìœ¼ë¡œ í•´ì„ ê°€ëŠ¥í•˜ë‹¤.</p>

<p>ìœ„ì˜ modelì´ ê¸°ì¡´ seq2seq modelì— ë¹„í•´ ê°€ì§€ëŠ” ì´ì ì€ encoderê°€ ê³ ì •ëœ size context vector 1ê°œì— ëª¨ë“  input sentence tokenì— ëŒ€í•œ attentionì„ ë‹´ì„ í•„ìš”ê°€ ì—†ë‹¤ëŠ” ê²ƒì´ë‹¤. ì™œëƒí•˜ë©´ decoder modelì—ì„œ ë‹¨ì§€ context vector 1ê°œë§Œ ì‚¬ìš©í•´ output sentenceë¥¼ ìƒì„±í•´ë‚´ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, $h_j$ì™€ ê°™ì€ input sentence tokenì— ëŒ€í•œ attention dataë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì´ë‹¤.</p>

<h1 id="encoder">Encoder</h1>

<p><img src="assets/images/2021-01-19-Neural-Machine-Translation-By-Jointly-Learning-To-Align-And-Translate/Untitled%205.png" alt="Neural%20Machine%20Translation%20By%20Jointly%20Learning%20To%20%20aee56874a5c645b08df4a6b823d6e1f7/Untitled%205.png" /></p>

<p>ê¸°ì¡´ seq2seq modelì—ì„œëŠ” encoderëŠ” 1ê°œì˜ context vectorë¥¼ ìƒì„±í•´ë‚´ê¸° ìœ„í•´ ì¡´ì¬í–ˆë‹¤. í•˜ì§€ë§Œ ë³¸ modelì€ ìœ„ì—ì„œ ì–¸ê¸‰í–ˆë“¯ì´ í•˜ë‚˜ì˜ context vectorê°€ ì•„ë‹Œ ê° ì‹œì ì— ëŒ€í•œ context vectorë¥¼ ê°ê° ìƒì„±í•œë‹¤. ì´ ë•Œ ì‚¬ìš©í•˜ëŠ” $h_j$ë¥¼ êµ¬í•˜ëŠ” ê²ƒì´ encoderì˜ ì—­í• ì´ë‹¤. $h_j$ëŠ” ìœ„ì—ì„œ ì–¸ê¸‰í–ˆë“¯ì´ $j$ë²ˆì§¸ input tokenì— ëŒ€í•´ attentioní•œ vectorì´ë‹¤. ì´ ë•Œ attentioní•œë‹¤ëŠ” ì˜ë¯¸ëŠ” $j$ë²ˆì§¸ input tokenì— ëŒ€í•´ ë‹¹ì—°íˆ ê°€ì¥ ë†’ì€ ê°€ì¤‘ì¹˜ë¥¼ ì£¼ê³ , $j$ë²ˆì§¸ì—ì„œ ë©€ì–´ì§ˆìˆ˜ë¡ ë‚®ì€ ê°€ì¤‘ì¹˜ë¥¼ ì£¼ëŠ” ê²ƒì´ë‹¤. ì´ëŠ” $j-1$, $j-2$ â€¦ì˜ ì—­ë°©í–¥, $j+1$, $j+2$ â€¦ì˜ ìˆœë°©í–¥, ì¦‰ ì–‘ë°©í–¥ì— ëŒ€í•´ ëª¨ë‘ ì ìš©ë˜ì–´ì•¼ í•œë‹¤. ì´ë¥¼ ìœ„í•´ ì‚¬ìš©í•œ ê²ƒì´ Bidirectional RNNì´ë‹¤. ìˆœë°©í–¥ì— ëŒ€í•œ $h_j$ë¥¼ ìƒì„±í•˜ê³ , input sentenceì˜ ëì— ë„ë‹¬í•˜ë©´ ë‹¤ì‹œ ì—­ë°©í–¥ì— ëŒ€í•œ $h_J$ë¥¼ ìƒì„±í•œë‹¤. ê·¸ í›„ ìˆœë°©í–¥ì— ëŒ€í•œ $\overrightarrow{h_j}$ì™€ ì—­ë°©í–¥ì— ëŒ€í•œ $\overleftarrow{h_j}$ë¥¼ í•¨ê»˜ ë°˜ì˜í•´ ìµœì¢… $h_j$ë¥¼ ë§Œë“¤ì–´ë‚¸ë‹¤.</p>

<h1 id="results">Results</h1>

<p>ë³¸ ë…¼ë¬¸ì—ì„œ ê°œë°œí•œ attention seq2seq modelì„ RNNsearchë¼ê³  ëª…ëª…í•œë‹¤. ì´ì „ seq2seq modelì€ RNNencdecë¼ê³  ëª…ëª…í•œë‹¤.</p>

<p>model ëª… ë’¤ì˜ ìˆ«ìëŠ” train ì‹œ ì‚¬ìš©í–ˆë˜ datasetì˜ ìµœëŒ€ setnence lengthì´ë‹¤.</p>

<p><img src="/assets/images/2021-01-19-Neural-Machine-Translation-By-Jointly-Learning-To-Align-And-Translate/05-21-2020-23.48.17.jpg" alt="Neural%20Machine%20Translation%20By%20Jointly%20Learning%20To%20%20aee56874a5c645b08df4a6b823d6e1f7/05-21-2020-23.48.17.jpg" /></p>

<p>ê°€ì¥ ì£¼ëª©í• ë§Œí•œ ì ì€ sentence lengthì— ê´€ê³„ì—†ì´ robustí•œ ê²°ê³¼ë¥¼ ë³´ì—¬ì¤¬ë‹¤ëŠ” ê²ƒì´ë‹¤. ì´ë¥¼ í†µí•´ fixed length context vectorì— ëª¨ë“  contextë¥¼ ì €ì¥í•¨ìœ¼ë¡œì¨ ë°œìƒí•œ bottleneckì„ í•´ê²°í–ˆë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.</p>

<p><img src="assets/images/2021-01-19-Neural-Machine-Translation-By-Jointly-Learning-To-Align-And-Translate/05-21-2020-23.49.09.jpg" alt="Neural%20Machine%20Translation%20By%20Jointly%20Learning%20To%20%20aee56874a5c645b08df4a6b823d6e1f7/05-21-2020-23.49.09.jpg" /></p>

<p>UNK (Out Of Vocabulary)ë¥¼ í¬í•¨í•œ ê²½ìš°ì™€ í¬í•¨í•˜ì§€ ì•Šì€ ê²½ìš° ëª¨ë‘ ê¸°ì¡´ seq2seq modelë³´ë‹¤ ì›”ë“±í•œ ìˆ˜ì¹˜ë¥¼ ë³´ì—¬ì¤¬ë‹¤. RNNsearch-50*ëŠ” ë”ì´ìƒ ì„±ëŠ¥ í–¥ìƒì´ ì—†ì„ ë•Œê¹Œì§€ ê³„ì† trainingì„ ì‹œí‚¨ modelì´ë‹¤.</p>

<p><img src="assets/images/2021-01-19-Neural-Machine-Translation-By-Jointly-Learning-To-Align-And-Translate/05-21-2020-23.48.55.jpg" alt="Neural%20Machine%20Translation%20By%20Jointly%20Learning%20To%20%20aee56874a5c645b08df4a6b823d6e1f7/05-21-2020-23.48.55.jpg" /></p>

<p>ìœ„ëŠ” $a_{ij}$ë¥¼ ì‹œê°í™”í•œ ê·¸ë¦¼ì¸ë°, ëŒ€ì²´ë¡œ monotonicí•œ matchë¥¼ ë³¼ ìˆ˜ ìˆë‹¤. English-French translateì´ê¸°ì— ê·¸ë ‡ë‹¤. í•˜ì§€ë§Œ (a)ë¥¼ ë³´ë©´ ì¡°ì‚¬ë‚˜ ëª…ì‚¬ì— ëŒ€í•´ì„œ monotonicí•˜ì§€ ì•Šì€ caseê°€ ìˆìŒì—ë„ ë¶ˆêµ¬í•˜ê³  ì •í™•íˆ alignì„ í–ˆë‹¤ëŠ” ì‚¬ì‹¤ì„ í™•ì¸ ê°€ëŠ¥í•˜ë‹¤. (d)ì—ì„œëŠ” ë³¸ modelì—ì„œ ì±„íƒí•œ soft-align ë°©ì‹ì˜ ì´ì ì´ ë“œëŸ¬ë‚œë‹¤. soft-alignì´ë€ ê°€ì¥ ë†’ì€ í™•ë¥ ê°’ì„ ê°€ì§„ token pair 1ê°œë§Œì„ ì±„íƒí•´ aligní•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì—¬ëŸ¬ tokenì— ëŒ€í•´ ê°ê°ì˜ align probabilityë¥¼ ì ìš©í•´ softí•˜ê²Œ aligní–ˆë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤. ë§Œì•½ soft-alignì´ ì•„ë‹Œ hard-alignì„ í–ˆë‹¤ë©´ [the man]ì˜ 2ê°œì˜ tokenì„ ê°ê° [lâ€™ homme]ì˜ ë‘ token ì¤‘ í•˜ë‚˜ì— aligní•´ì•¼ í•˜ëŠ”ë° ì´ëŸ¬í•œ ì‘ì—…ì€ translationì— ê²°ì½” ë„ì›€ì´ ë˜ì§€ ì•ŠëŠ”ë‹¤. ë”°ë¼ì„œ soft-alignì„ ì‚¬ìš©í•´ ì—¬ëŸ¬ tokenì— ëŒ€í•œ alignì„ ëª¨ë‘ ê³ ë ¤í•˜ëŠ” ë°©ì‹ì´ ì í•©í•˜ë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.</p>
:ET